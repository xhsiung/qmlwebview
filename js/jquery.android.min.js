(function(a){a.fn.extend({androidEvent:function(c,b){return this.each(function(){if(!b){console.log("no function specified");return}a(this).data("ebusEventFilter",c).on("ebusEvent",b)})}});a.android={connect:function(b,c){a.android.host=a.android.getUrlVars()["socketurl"];a.android.ws=new WebSocket(a.android.host);a.android.ws.onopen=function(){a(".androidConnected").add(document).add(window).trigger("androidConnected");if(b){b(a.android.ws)}};a.android.ws.onerror=function(d){a(".androidConnectedError").add(document).add(window).trigger("androidConnectedError");if(c){c(d)}};a.android.ws.onmessage=function(d){var e=JSON.parse(d.data);a(".android-listener").each(function(){var h=a(this).data("androidEventFilter");var f=true;if(h){for(var g in h){var i=h[g];if(e[g]!=i){f=false;break}}}if(f){a(this).trigger("androidEvent",[e])}})};a.android.ws.onclose=function(d){a(".androidDisconnected").add(document).add(window).trigger("androidDisconnected");if(c){c(d)}}},disconnect:function(){a.android.ws.close()},send:function(b){a.android.ws.send(JSON.stringify(b))},getUrlVars:function(){var e=[],d;var b=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var c=0;c<b.length;c++){d=b[c].split("=");e.push(d[0]);e[d[0]]=d[1]}return e},host:null,ws:null,_state:{}};a.event.special.androidEvent={setup:function(c,b){a(this).addClass("android-listener")},teardown:function(b){a(this).removeClass("android-listener")}};a.event.special.androidConnected={setup:function(c,b){a(this).addClass("androidConnected")},teardown:function(b){a(this).removeClass("androidConnected")}};a.event.special.androidDisconnected={setup:function(c,b){a(this).addClass("androidDisconnected")},teardown:function(b){a(this).removeClass("androidDisconnected")}};a.event.special.androidConnectedError={setup:function(c,b){a(this).addClass("androidConnectedError")},teardown:function(b){a(this).removeClass("androidConnectedError")}}})(jQuery);